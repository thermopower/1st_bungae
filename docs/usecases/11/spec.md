# UC-011: 지원 내역 조회

## 1. 유스케이스 정보

| 항목 | 내용 |
|------|------|
| **유스케이스 ID** | UC-011 |
| **유스케이스 이름** | 지원 내역 조회 |
| **액터** | 인플루언서 (정보 등록 완료) |
| **우선순위** | 중간 |
| **관련 기능** | 체험단 지원 관리 |

## 2. 사전조건 (Preconditions)

- 사용자가 로그인 상태
- User.role이 'influencer'
- Influencer 정보가 등록되어 있음

## 3. 사후조건 (Postconditions)

### 성공 시
- 인플루언서가 지원한 체험단 목록 표시
- 각 지원의 선정 상태 표시

## 4. 주요 플로우 (Main Flow)

1. 인플루언서가 네비게이션 바에서 "내 지원내역" 버튼 클릭
2. 지원 내역 페이지(`/influencer/applications`)로 이동
3. **시스템**: 로그인 여부 검증
4. **시스템**: 인플루언서 권한 검증
   - Influencer 테이블에서 user_id로 레코드 조회
   - 인플루언서 정보 미등록 시: "인플루언서 정보를 먼저 등록해주세요" + 정보 등록 페이지로 리다이렉트
5. **시스템**: 지원 내역 조회
   - Application 테이블에서 influencer_id로 조회
   - JOIN Campaign, Advertiser 테이블 (체험단 정보, 광고주 정보)
   - 정렬: applied_at DESC (최신순)
6. **시스템**: 각 지원 내역 표시
   - 체험단 제목
   - 광고주 업체명
   - 지원 일시
   - 선정 상태 (지원완료, 선정됨, 탈락)
   - 체험단 상세 링크
7. **시스템**: 상태별 필터 제공 (선택)
   - 전체 보기 (기본값)
   - 지원완료 (APPLIED)
   - 선정됨 (SELECTED)
   - 탈락 (REJECTED)

## 5. 대체 플로우 (Alternative Flows)

### 5.1 미로그인 상태
- **시점**: 3단계 (로그인 검증)
- **조건**: 세션에 user_id 없음
- **처리**:
  - 로그인 페이지로 리다이렉트

### 5.2 인플루언서 권한 없음
- **시점**: 4단계 (인플루언서 권한 검증)
- **조건**: Influencer 테이블에 user_id로 레코드 없음
- **처리**:
  - "인플루언서 정보를 먼저 등록해주세요" 메시지 표시
  - 인플루언서 정보 등록 페이지로 리다이렉트

### 5.3 지원 내역 없음
- **시점**: 5단계 (지원 내역 조회)
- **조건**: Application 레코드 없음
- **처리**:
  - "아직 지원한 체험단이 없습니다" 메시지 표시
  - 홈 바로가기 버튼 제공

### 5.4 상태별 필터 적용
- **시점**: 7단계 (상태별 필터)
- **조건**: 사용자가 특정 상태 선택
- **처리**:
  - Application.status로 필터링
  - 해당 상태의 지원 내역만 표시

## 6. 예외 플로우 (Exception Flows)

### 6.1 DB 조회 실패
- **조건**: Application 테이블 조회 실패
- **처리**:
  - "일시적인 오류가 발생했습니다" 메시지 표시

## 7. 비즈니스 규칙 (Business Rules)

### BR-001: 본인 지원 내역만 조회
- Application.influencer_id = 현재 인플루언서 ID
- 다른 인플루언서의 지원 내역 조회 불가

### BR-002: 지원 상태 표시
- APPLIED: "지원완료"
- SELECTED: "선정됨"
- REJECTED: "탈락"

### BR-003: 최신순 정렬
- applied_at DESC (지원일시 기준 최신순)

## 8. UI/UX 요구사항

### 필터 영역
- 상태 필터: 드롭다운 또는 탭
  - 전체 보기 (기본값)
  - 지원완료
  - 선정됨
  - 탈락

### 지원 내역 목록
- 각 지원별로 카드 또는 리스트 형식 표시
- 표시 정보:
  - 체험단 제목 (링크)
  - 광고주 업체명
  - 지원 일시 (예: "2025-11-14 12:00")
  - 선정 상태 (배지 형식)
    - 지원완료: 파란색
    - 선정됨: 초록색
    - 탈락: 회색
  - "상세보기" 버튼 → 체험단 상세 페이지

### 메시지
- "아직 지원한 체험단이 없습니다"
- "일시적인 오류가 발생했습니다"

### 버튼
- "체험단 탐색하기" 버튼 (지원 내역 없을 때) → 홈으로 이동

## 9. 데이터 모델

### 입력 데이터 (쿼리 파라미터)
```json
{
  "status_filter": "all" | "applied" | "selected" | "rejected"
}
```

### 출력 데이터 (성공 시)
```json
{
  "applications": [
    {
      "id": 1,
      "status": "APPLIED",
      "applied_at": "2025-11-14T12:00:00Z",
      "campaign": {
        "id": 1,
        "title": "신메뉴 파스타 체험단 모집",
        "end_date": "2025-11-30",
        "status": "RECRUITING"
      },
      "advertiser": {
        "business_name": "테스트 카페"
      }
    }
  ],
  "total_count": 5,
  "status_counts": {
    "applied": 3,
    "selected": 1,
    "rejected": 1
  }
}
```

## 10. 시퀀스 다이어그램

```
인플루언서 -> 네비게이션 바: "내 지원내역" 클릭
네비게이션 바 -> 지원 내역 페이지: 이동
지원 내역 페이지 -> AuthService: 로그인 검증
AuthService --> 지원 내역 페이지: 검증 성공
지원 내역 페이지 -> DB (Influencer): 인플루언서 권한 검증
DB (Influencer) --> 지원 내역 페이지: 검증 성공
지원 내역 페이지 -> DB (Application): 지원 내역 조회 (JOIN Campaign, Advertiser)
DB (Application) --> 지원 내역 페이지: 지원 내역 반환
지원 내역 페이지 -> 인플루언서: 지원 내역 목록 표시
```

## 11. 테스트 시나리오

### 11.1 정상 조회 (지원 내역 있음)
- **Given**: 인플루언서가 3개 체험단에 지원
- **When**: "내 지원내역" 클릭
- **Then**: 3개의 지원 내역 표시 (최신순)

### 11.2 지원 내역 없음
- **Given**: 지원한 체험단이 없는 인플루언서
- **When**: "내 지원내역" 클릭
- **Then**: "아직 지원한 체험단이 없습니다" 메시지, "체험단 탐색하기" 버튼 표시

### 11.3 상태별 필터 (선정됨만)
- **Given**: 지원 내역 5개 (선정됨 2개, 탈락 3개)
- **When**: "선정됨" 필터 선택
- **Then**: 선정된 2개 지원 내역만 표시

### 11.4 인플루언서 권한 없음
- **Given**: 인플루언서 정보가 등록되지 않은 사용자
- **When**: "내 지원내역" 접근
- **Then**: "인플루언서 정보를 먼저 등록해주세요" 메시지, 정보 등록 페이지로 리다이렉트

### 11.5 체험단 상세보기
- **Given**: 지원 내역 목록
- **When**: 특정 지원의 "상세보기" 클릭
- **Then**: 해당 체험단 상세 페이지로 이동

## 12. 참고 문서

- `docs/userflow.md`: 지원 내역 조회 플로우 (7.4)
- `docs/prd.md`: 지원 내역 조회 기능 (Phase 2 feature)
- `docs/database.md`: Application 테이블 스키마 (3.5)
