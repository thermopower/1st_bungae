-- ============================================
-- í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ìº í˜ì¸ ìƒì„± SQL
-- ============================================
-- ì‚¬ìš© ë°©ë²•:
-- 1. Supabase Dashboard > SQL Editorì—ì„œ ì‹¤í–‰
-- 2. ë˜ëŠ” ë¡œì»¬ì—ì„œ: psql -h aws-1-ap-southeast-2.pooler.supabase.com -p 5432 -U postgres.ffspgejgzkjxufjsjrry -d postgres < test_sample_campaigns.sql

-- ============================================
-- Step 1: í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì í™•ì¸
-- ============================================
-- ì£¼ì˜: ì•„ë˜ user_idëŠ” ì‹¤ì œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ UUIDë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤
-- SELECT id, email FROM users ORDER BY created_at DESC LIMIT 5;

-- ============================================
-- Step 2: í…ŒìŠ¤íŠ¸ìš© ê´‘ê³ ì£¼ ìƒì„± (ì´ë¯¸ ê´‘ê³ ì£¼ ì •ë³´ë¥¼ ë“±ë¡í–ˆë‹¤ë©´ SKIP)
-- ============================================
-- ì‹¤ì œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì IDë¡œ ë³€ê²½í•˜ì„¸ìš”
-- DO $$
-- DECLARE
--     test_user_id UUID := 'ì‹¤ì œ-ì‚¬ìš©ì-UUID-ì…ë ¥';
-- BEGIN
--     -- ì´ë¯¸ ê´‘ê³ ì£¼ ì •ë³´ê°€ ìˆëŠ”ì§€ í™•ì¸
--     IF NOT EXISTS (SELECT 1 FROM advertiser WHERE user_id = test_user_id) THEN
--         -- ê´‘ê³ ì£¼ ì •ë³´ ë“±ë¡
--         INSERT INTO advertiser (
--             user_id, name, birth_date, phone_number,
--             business_name, address, business_phone,
--             business_number, representative_name
--         ) VALUES (
--             test_user_id,
--             'í…ŒìŠ¤íŠ¸ ê´‘ê³ ì£¼',
--             '1985-05-15',
--             '010-1234-5678',
--             'ë§›ìˆëŠ” ì¹´í˜',
--             'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123',
--             '02-1234-5678',
--             '1234567890',
--             'ê¹€ëŒ€í‘œ'
--         );

--         -- User í…Œì´ë¸”ì˜ role ì—…ë°ì´íŠ¸
--         UPDATE users SET role = 'advertiser' WHERE id = test_user_id;
--     END IF;
-- END $$;

-- ============================================
-- Step 3: ìƒ˜í”Œ ìº í˜ì¸ 2ê°œ ìƒì„±
-- ============================================
-- ë°©ë²• 1: í˜„ì¬ ë¡œê·¸ì¸í•œ ê´‘ê³ ì£¼ì˜ IDë¥¼ ì‚¬ìš©
-- (ê´‘ê³ ì£¼ ì •ë³´ë¥¼ ì´ë¯¸ ë“±ë¡í–ˆë‹¤ë©´ ì´ ë°©ë²• ì‚¬ìš©)

-- í˜„ì¬ ê´‘ê³ ì£¼ ID í™•ì¸
-- SELECT id, business_name FROM advertiser ORDER BY created_at DESC LIMIT 1;

-- ìƒ˜í”Œ ìº í˜ì¸ 1: ì‹ ë©”ë‰´ íŒŒìŠ¤íƒ€ ì²´í—˜ë‹¨
INSERT INTO campaign (
    advertiser_id,
    title,
    description,
    quota,
    start_date,
    end_date,
    benefits,
    conditions,
    status,
    created_at
)
SELECT
    a.id,  -- ê°€ì¥ ìµœê·¼ì— ë“±ë¡ëœ ê´‘ê³ ì£¼ ID ì‚¬ìš©
    'ğŸ ì‹ ë©”ë‰´ íŒŒìŠ¤íƒ€ ì²´í—˜ë‹¨ ëª¨ì§‘',
    E'ì•ˆë…•í•˜ì„¸ìš”! ë§›ìˆëŠ” ì¹´í˜ì…ë‹ˆë‹¤.\n\nì´ë²ˆì— ìƒˆë¡­ê²Œ ì¶œì‹œí•œ í”„ë¦¬ë¯¸ì—„ íŒŒìŠ¤íƒ€ ë©”ë‰´ë¥¼ ì²´í—˜í•˜ê³  ì†”ì§í•œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì‹¤ ì¸í”Œë£¨ì–¸ì„œë¶„ë“¤ì„ ëª¨ì§‘í•©ë‹ˆë‹¤.\n\nâœ¨ ì œê³µ ë©”ë‰´:\n- í¬ë¦¼ íŒŒìŠ¤íƒ€ (1ì¸ë¶„)\n- í† ë§ˆí†  íŒŒìŠ¤íƒ€ (1ì¸ë¶„)\n- ìŒë£Œ 2ì”\n- ë””ì €íŠ¸ 1ê°œ\n\nğŸ“¸ ì´¬ì˜ ê°€ëŠ¥í•œ í¬í† ì¡´ê³¼ ì¡°ëª…ì´ ì¤€ë¹„ë˜ì–´ ìˆìŠµë‹ˆë‹¤!',
    5,
    CURRENT_DATE,
    CURRENT_DATE + INTERVAL '15 days',
    E'âœ… íŒŒìŠ¤íƒ€ 2ì¢… + ìŒë£Œ 2ì” + ë””ì €íŠ¸ ë¬´ë£Œ ì œê³µ\nâœ… í¬í† ì¡´ ì´¬ì˜ ì§€ì›\nâœ… ì¬ë°©ë¬¸ ì‹œ 20% í• ì¸ ì¿ í°',
    E'âœ”ï¸ ì¸ìŠ¤íƒ€ê·¸ë¨ í”¼ë“œ í¬ìŠ¤íŒ… 1ê°œ (ìµœì†Œ 3ì¥ ì´ìƒ)\nâœ”ï¸ ìŠ¤í† ë¦¬ 2ê°œ ì´ìƒ ì—…ë¡œë“œ\nâœ”ï¸ í•´ì‹œíƒœê·¸: #ë§›ìˆëŠ”ì¹´í˜ #ì‹ ë©”ë‰´íŒŒìŠ¤íƒ€ #ê°•ë‚¨ë§›ì§‘ í¬í•¨\nâœ”ï¸ ë°©ë¬¸ í›„ 3ì¼ ì´ë‚´ ì—…ë¡œë“œ',
    'RECRUITING',
    NOW()
FROM advertiser a
ORDER BY a.created_at DESC
LIMIT 1;

-- ìƒ˜í”Œ ìº í˜ì¸ 2: í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¹ë³„ ìŒë£Œ ì²´í—˜ë‹¨
INSERT INTO campaign (
    advertiser_id,
    title,
    description,
    quota,
    start_date,
    end_date,
    benefits,
    conditions,
    status,
    created_at
)
SELECT
    a.id,  -- ê°€ì¥ ìµœê·¼ì— ë“±ë¡ëœ ê´‘ê³ ì£¼ ID ì‚¬ìš©
    'ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¹ë³„ ìŒë£Œ ì²´í—˜ë‹¨',
    E'í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì‹œì¦Œì„ ë§ì•„ íŠ¹ë³„í•œ ì‹œê·¸ë‹ˆì²˜ ìŒë£Œë¥¼ ì„ ë³´ì…ë‹ˆë‹¤!\n\nì´ë²ˆ ì‹œì¦Œ í•œì • ë©”ë‰´ë¥¼ ë¨¼ì € ì²´í—˜í•˜ê³  ë¦¬ë·°í•´ì£¼ì‹¤ ë¶„ë“¤ì„ ì°¾ìŠµë‹ˆë‹¤.\n\nğŸ… ì‹œì¦Œ í•œì • ë©”ë‰´:\n- ì§„ì €ë¸Œë ˆë“œ ë¼ë–¼\n- í˜í¼ë¯¼íŠ¸ ëª¨ì¹´\n- í™”ì´íŠ¸ ì´ˆì½œë¦¿ ë¼ë–¼\n- í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì¿ í‚¤ ì„¸íŠ¸\n\nğŸ ì˜ˆìœ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë°ì½”ë ˆì´ì…˜ê³¼ í•¨ê»˜ ì¸ìƒìƒ·ì„ ë‚¨ê²¨ë³´ì„¸ìš”!',
    8,
    CURRENT_DATE,
    CURRENT_DATE + INTERVAL '20 days',
    E'âœ… ì‹œì¦Œ í•œì • ìŒë£Œ 3ì¢… + ì¿ í‚¤ ì„¸íŠ¸ ë¬´ë£Œ ì œê³µ\nâœ… í¬ë¦¬ìŠ¤ë§ˆìŠ¤ í¬í† ì¡´ ì´¬ì˜\nâœ… êµ¿ì¦ˆ ì¦ì • (ì—ì½”ë°± ë˜ëŠ” í…€ë¸”ëŸ¬)\nâœ… ë‹¤ìŒ ë°©ë¬¸ ì‹œ 30% í• ì¸ ì¿ í°',
    E'âœ”ï¸ ì¸ìŠ¤íƒ€ê·¸ë¨ ë¦´ìŠ¤ ë˜ëŠ” ìœ íŠœë¸Œ ì‡¼ì¸  1ê°œ (ìµœì†Œ 30ì´ˆ ì´ìƒ)\nâœ”ï¸ ì¸ìŠ¤íƒ€ê·¸ë¨ í”¼ë“œ í¬ìŠ¤íŒ… 1ê°œ\nâœ”ï¸ ìŠ¤í† ë¦¬ 3ê°œ ì´ìƒ ì—…ë¡œë“œ\nâœ”ï¸ í•´ì‹œíƒœê·¸: #ë§›ìˆëŠ”ì¹´í˜ #í¬ë¦¬ìŠ¤ë§ˆìŠ¤ìŒë£Œ #ì‹œì¦Œí•œì • #ê°•ë‚¨ì¹´í˜ í¬í•¨\nâœ”ï¸ íŒ”ë¡œì›Œ 5,000ëª… ì´ìƒ\nâœ”ï¸ ë°©ë¬¸ í›„ 5ì¼ ì´ë‚´ ì—…ë¡œë“œ',
    'RECRUITING',
    NOW()
FROM advertiser a
ORDER BY a.created_at DESC
LIMIT 1;

-- ============================================
-- Step 4: ìƒì„±ëœ ìº í˜ì¸ í™•ì¸
-- ============================================
SELECT
    c.id,
    c.title,
    c.quota,
    c.start_date,
    c.end_date,
    c.status,
    a.business_name,
    c.created_at
FROM campaign c
JOIN advertiser a ON c.advertiser_id = a.id
ORDER BY c.created_at DESC
LIMIT 5;

-- ============================================
-- ì°¸ê³ : ìº í˜ì¸ ì‚­ì œ (í…ŒìŠ¤íŠ¸ìš©)
-- ============================================
-- DELETE FROM campaign WHERE id IN (1, 2);  -- IDëŠ” ì‹¤ì œ ìƒì„±ëœ ìº í˜ì¸ IDë¡œ ë³€ê²½
